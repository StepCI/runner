version: "1.0"
name: Captures
env:
  host: jsonplaceholder.typicode.com
  resource: posts
  complex:
    id: 1
    info:
      name: Step CI
tests:
  example:
    steps:
      - name: Post the post
        url: https://{{env.host}}/{{env.resource}}
        method: POST
        headers:
          Content-Type: application/json
        json:
          title: Hello {{env.complex.info.name}}!
          body: This is the body
          userId: '{{env.complex.id}}'
        captures:
          id:
            jsonpath: $.id
        check:
          status: 201
          captures:
            id: 101
      - name: Get post by id
        url: https://{{env.host}}/{{env.resource}}/{{captures.id}}
        method: GET
        headers:
          Content-Type: application/json
        check:
          status: 404
          headers:
            Content-Type: application/json; charset=utf-8
          body: "{}"
      - name: Get Fixed Post
        url: https://{{env.host}}/{{env.resource}}/{{env.complex.id}}
        method: GET
        headers:
          Content-Type: application/json
        check:
          status: 200
          jsonpath:
            $.id:
              - lt: "{{captures.id}}"
              - isNumber: true
            $.userId:
              - lt: "{{captures.id}}"
              - isNumber: true